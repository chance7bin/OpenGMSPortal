<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title th:text="${datainfo.data.name}+' | Data Item Info | OpenGMS'"></title>
    <meta name="viewport"
          content="width=device-width,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"/>

    <link rel="icon" type="image/x-icon" th:href="@{/static/img/logo/favicon.ico}">
    <link rel="stylesheet" th:href="@{/static/lib/element-ui/theme-chalk/index.css}">

    <link rel="stylesheet" href="../static/css/base/bootstrap.min.css"
          th:href="@{/../static/css/base/bootstrap.min.css}">
    <link rel="stylesheet" href="../static//css/base/font-awesome/css/font-awesome.min.css"
          th:href="@{/../static//css/base/font-awesome/css/font-awesome.min.css}">
    <link rel="stylesheet" href="../static/css/font-awesome/fonts/fontawesome-webfont.woff"
          th:href="@{/../static/css/font-awesome/fonts/fontawesome-webfont.woff}">

    <link rel="stylesheet" href="/static/css/base/relate_item.css">

    <link rel="stylesheet" href="../static/css/base/style.css" th:href="@{/../static/css/base/style.css}">
    <link rel="stylesheet" href="../static/css/base/universal.css" th:href="@{/../static/css/base/universal.css}">
    <link rel="stylesheet" href="/static/css/base/itemInfo.css">
    <link rel="stylesheet" href="../static/css/page/data_item_info.css"
          th:href="@{/../static/css/page/data_item_info.css}">
    <link rel="stylesheet" href="../static/css/components/file-manager.css"
          th:href="@{/../static/css/components/file-manager.css}">

    <link rel="stylesheet" type="text/css" media="screen" href="/static/css/base/footerResponse.css"/>
    <link rel="stylesheet" type="text/css" media="screen" href="/static/css/base/navbar.css"/>

    <style type="text/css" th:inline="css">
        .col-md-5 {
            float: none;
        }

        .align-right {
            font-weight: bold;
            text-align: right;
        }

        .custom-tree-node {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 17px;
            padding-right: 8px;
        }
    </style>
</head>
<body>
<div id="data_item_info">
    <div th:replace="fragments/navbar :: unlog"></div>


    <div class="clearfix" style="padding:40px 0px;height: auto;position: relative;">
        <div class="left-panel el-col">
            <div class="detail">
                <div class="detail_title" th:object="${datainfo}">
                    <h2 style="display: inline-block" th:text="${datainfo.data.name}"></h2>
                    <div class="pull-right">

                        <el-tooltip popper-class="fontsize-15" content="Edit" effect="light" placement="top">
                            <a th:if="${datainfo.data.status=='Public'&&datainfo.data.lock!=true}" href="javascript:void(0)" class='fa fa-pencil fa-2x' aria-hidden='true' @click="edit"></a>
                        </el-tooltip>
                        <el-tooltip popper-class="fontsize-15" content="There is another version haven't been reviewed, you can edit it later or contact us." effect="light" placement="top">
                            <li th:if="${datainfo.data.status=='Public'&&history!=true&&datainfo.data.lock==true}" class='fa fa-pencil fa-2x' style="color:#cccccc" aria-hidden='true'></li>
                        </el-tooltip>
                        <el-tooltip popper-class="fontsize-15" th:content="${datainfo.data.status}" effect="light" placement="top">
                            <i th:if="${datainfo.data.status=='Public'}" class="el-icon-unlock public fontsize-2em"></i>
                            <i th:if="${datainfo.data.status=='Discoverable'}" class="el-icon-unlock discoverable fontsize-2em"></i>
                            <i th:if="${datainfo.data.status=='Private'}" class="el-icon-lock private fontsize-2em"></i>
                        </el-tooltip>

                    </div>
                </div>

                <div class="detail_overview">
                    <div class="img" th:object="${datainfo}" v-if="">
                        <div th:if="${#strings.isEmpty(datainfo.data.image)}">
                            <avatar th:username="${datainfo.data.name}" :size="90" :rounded="false"></avatar>
                        </div>
                        <div th:unless="${#strings.isEmpty(datainfo.data.image)}">
                            <img th:src="${datainfo.data.image}" class="image">
                        </div>
                    </div>

                    <div class="info" th:object="${datainfo}">
                        <p th:text="${datainfo.data.overview}">description</p>
                        <div class="tags">
                            <span class="badge badge-info" th:each="key,iter : ${datainfo.data.keywords}"
                                  th:text="${iter.current}">itercurrent</span>
                        </div>
                    </div>

                    <div class="detail_option" th:object="${datainfo}">

                        <a class="fa fa-eye" aria-hidden="true"></a>&nbsp&nbsp<span
                            th:utext="${datainfo.data.viewCount}">{{viewCount}}</span>

                    </div>

                </div>

            </div>

            <div id="Owner0" class="detail_block minScreen">

                <div class="block_head">
                    <div class="head_text" style="padding-left: 10px;padding-right: 15px;display: inline-flex">
                        <h4>Contributor</h4>
                        <el-tooltip popper-class="fontsize-15" effect="light" content="Contributor is the person who contributes the item to OpenGMS, may not be the author of the item." placement="top">
                            <i class="fa fa-question-circle-o" aria-hidden="true" style="margin-top:4px;cursor:help;"></i>
                        </el-tooltip>
                    </div>
                </div>
                <div class="block_content">
                    <div class="el-row" style="margin-bottom: 3px;height: 40px;display: flex;justify-content: center;align-items: center;">
                        <user-avatar ref="mainContributorAvatar" style="width:40px;height: 40px;float:left;"></user-avatar>

                        <div class="el-col">
                            <div class="pull-left" style="display: block;margin-left: 15px;">
                                <a th:href="'/profile/'+${user.accessId}"><h4 th:text="${user.name}" style="padding: 0;">Tom Marvolo Riddle</h4></a>
                            </div>
                        </div>
                    </div>
                    <div class="el-row">
                        <div class="text-center">
                            <h5 th:text="'contributed at '+${#dates.format(datainfo.data.createTime,'yyyy-MM-dd')}">
                                contributed at 2018-7-13 14:32:18 </h5>
                        </div>
                    </div>
                </div>
            </div>

            <div id="Authorship0" class="detail_block minScreen"
                 th:if="${datainfo.data.authorships!=null&&#lists.size(datainfo.data.authorships)!=0}">
                <div class="block_head">
                    <div class="head_text" style="padding-left: 10px;padding-right: 15px;display: inline-flex">                         <h4>Authorship</h4>                         <el-tooltip popper-class="fontsize-15" effect="light"                                     content="We deeply understand that a model may be attributed to the efforts of a team. If all author information is not listed here, please click the feedback below."                                     placement="top">                             <i class="fa fa-question-circle-o" aria-hidden="true" style="margin-top:4px;cursor:help;"></i>                         </el-tooltip>                     </div>
                </div>
                <div class="block_content text-center" style="padding-left:10px">
                    <div style="text-align: left;" th:each="author,key:${datainfo.data.authorships}">
                        <span role="button" tabindex="0" class="ab" style="float: right;">
                            <a data-toggle="collapse" th:href="'#authorships'+${key.index}" class="detail-toggle" aria-expanded="true" >
                                <i class="fa fa-caret-up" style="font-size: 21px"></i>
                            </a>
                        </span>
                        <li class="NavHead" style="font-size: 16px;" th:text="${author.name}">NNU_Group</li>
                        <div th:id="'authorships'+${key.index}" class="panel-collapse" th:class="${key.index==0?'in':'collapse'}"aria-expanded="true"
                             style="">
                            <div class="panel-body" style="padding-left: 20px; padding-top: 7px; padding-right: 0px;">
                                <dl>
                                    <dt th:if="${author.ins!=''&&author.ins!=null}">Affiliation：</dt>
                                    <dd th:if="${author.ins!=''&&author.ins!=null}" th:text="${author.ins}"></dd>
                                    <div th:if="${author.email!='unknow'&&author.email!=''}">
                                        <dt>Email：</dt>
                                        <dd th:text="${author.email}">njgis@163.com</dd>
                                    </div>
                                    <dt>Home Page：</dt>
                                    <dd><a th:href="${author.homepage}">View</a></dd>
                                </dl>
                            </div>
                        </div>
                    </div>
                    <div th:if="${#lists.size(datainfo.data.authorships)>0}">
                        <el-tag type="info">Is authorship not correct? <a href="javascript:void(0)" @click="feedBack" style="text-decoration: underline">Feed back</a></el-tag>
                    </div>
                </div>
            </div>

            <div id="classification0" class="detail_block minScreen">
                <div class="block_head">
                    <div class="head_text">
                        <h4>Category Tags</h4>
                    </div>
                </div>
                <div class="block_content" style="margin-bottom:10px;">
                    <el-tag type="success" th:each="classS:${classifications}" th:text="${classS}"
                            style="margin: 0 10px 10px 0;font-weight: bold;color: #3396ef"></el-tag>
                </div>
            </div>

            <!--data resource url-->
            <div th:if="(${datainfo.data.url!=null}) and (${datainfo.data.url!=''})" id="data_url" class="detail_block">
                <div class="block_head">
                    <div class="head_text">
                        <h4>Data Resource Url</h4>
                    </div>
                </div>
                <div class="block_content flex">
                    <div id="data-url" class="">
                        <a th:href="${datainfo.data.url}"  target="_blank="><span
                                style="font-size: 17px;color: #67c23a;"
                                th:text="${datainfo.data.url}">current</span>
                        </a>
                    </div>

                </div>

            </div>

            <!--Data Resource-->
            <div th:if="(${userDataList}) and (${#arrays.length(userDataList)})" id="userDataList" class="detail_block">

                <div class="block_head">
                    <div class="head_text">
                        <h4>Data Resource</h4>
                    </div>
                </div>&nbsp;&nbsp;
                <el-card>
                <div class="el-card dataitemisol is-never-shadow"
                     th:each="data,key:${userDataList}"
                     th:title="${data.label}" shadow="never" th:id="${key.index}"
                     style="width: 150px;"><!---->
                    <a target="_blank"
                       th:href="${data.url}"
                       style="color:black">
                        <div class="el-card__body">
                            <div class="el-row">
                                <div class="el-col el-col-6">&nbsp;</div>
                                <div class="el-col el-col-12">
                                    <img
                                            th:src="'/static/img/filebrowser/'+${data.suffix}+'.svg'"
                                            onerror="this.onerror='';src='/static/img/filebrowser/unknow.svg'"
                                            style="width: 100%;">
                                </div>
                                <div class="el-col el-col-6">&nbsp;</div>
                            </div>
                            <div class="el-row" style="height: 45px;">
                                <div class="el-col el-col-2">&nbsp;</div>
                                <div class="el-col el-col-20"><p th:text="${data.label}+'.'+${data.suffix}"
                                                                 style="overflow: hidden;overflow-wrap: break-word; word-break: break-all; text-align: center;display: -webkit-box;-webkit-line-clamp: 2;-webkit-box-orient: vertical;line-height: 1.5">
                                </p></div>
                                <div class="el-col el-col-2">&nbsp;</div>
                            </div>
                        </div>
                    </a>
                </div>
                </el-card>
            </div>&nbsp;&nbsp;

            <!--Distributed Node Data-->
            <div  v-loading="loading" th:if="${#arrays.length(fileName)}" id="distributedNodeData" class="detail_block">
                <div class="block_head">
                    <div class="head_text">
                        <h4>Distributed Node Data</h4>
                    </div>
                </div>&nbsp;&nbsp;
                <div>
                    <el-card>
                        <div class="el-card dataitemisol is-never-shadow"
                             v-for="data"
                             style="width: 150px;"><!---->
                            <!--<a target="_blank"-->
                               <!--th:href="${data.url}"-->
                               <!--style="color:black">-->
                                <div class="el-card__body">
                                    <div class="el-row">
                                        <div class="el-col el-col-6">&nbsp;</div>
                                        <div class="el-col el-col-12">
                                            <img
                                                    src="/static/img/filebrowser/undefine.svg"
                                                    onerror="this.onerror='';src='/static/img/filebrowser/unknow.svg'"
                                                    style="width: 100%;">
                                        </div>
                                        <div class="el-col el-col-6">&nbsp;</div>
                                    </div>
                                    <div class="el-row" style="height: 45px;">
                                        <div class="el-col el-col-2">&nbsp;</div>
                                        <div class="el-col el-col-20"><p th:text="${data}"
                                                                         style="overflow: hidden;overflow-wrap: break-word; word-break: break-all; text-align: center;display: -webkit-box;-webkit-line-clamp: 2;-webkit-box-orient: vertical;line-height: 1.5">
                                        </p></div>
                                        <div class="el-col el-col-2">&nbsp;</div>
                                    </div>
                                </div>
                            <!--</a>-->
                        </div>
                    </el-card>

                </div>&nbsp;&nbsp;
                <div>
                    <p style="display: inline-block">You can apply to download this data:</p>
                    <el-button class="value" type="success" round style="display: inline-block" @click="downLoadDistributedNodeData">DownLoad</el-button>
                    <!--<p class="connect" style="display: none;color: mediumblue;font-size: larger;font-weight: 600;">Connecting Distributed Node...</p>-->
                </div>
            </div>&nbsp;&nbsp;


            <!--Distributed Node Data2-->
            <div  v-loading="loading" th:if="${not #strings.isEmpty(distributeData)}" id="distributedNodeData2" class="detail_block">
                <div class="block_head">
                    <div class="head_text">
                        <h4>Distributed Node Data</h4>
                    </div>
                </div>&nbsp;&nbsp;
                <div>
                    <el-card>
                        <div class="el-card dataitemisol is-never-shadow"
                             v-for="(data, index) in invokeServices"
                             :title="data.name" shadow="never"
                             style="width: 150px;"><!---->
                            <!--<a target="_blank"-->
                               <!--th:href="${data.url}"-->
                               <!--style="color:black">-->
                                <div class="el-card__body downloadBtn" @click="downloadDisData($event)">
                                    <div class="el-row">
                                        <div class="el-col el-col-6">&nbsp;</div>
                                        <div class="el-col el-col-12">
                                            <img
                                                    src="/static/img/filebrowser/undefine.svg"
                                                    onerror="this.onerror='';src='/static/img/filebrowser/unknow.svg'"
                                                    style="width: 100%;">
                                        </div>
                                        <div class="el-col el-col-6">&nbsp;</div>
                                    </div>
                                    <div class="el-row" style="height: 45px;">
                                        <div class="el-col el-col-2">&nbsp;</div>
                                        <div class="el-col el-col-20">
                                            <p
                                                                         style="overflow: hidden;overflow-wrap: break-word;
                                                                         word-break: break-all; text-align: center;display:
                                                                         -webkit-box;-webkit-line-clamp: 2;-webkit-box-orient: vertical;
                                                                         line-height: 1.5">{{data.name}}
                                            </p>
                                        </div>
                                        <div class="el-col el-col-2">&nbsp;</div>
                                    </div>
                                </div>
                            <!--</a>-->
                        </div>
                    </el-card>

                </div>
            </div>&nbsp;&nbsp;

            <!--description-->
            <div th:if="${datainfo.data.detail!=''&&datainfo.data.detail!=null}" id="description" class="detail_block">
                <div class="block_head">
                    <div class="head_text">
                        <h4>Detailed Description</h4>
                    </div>
                </div>
                <div class="block_content">
                    <div id="detail" class="detailIntroducePanel" th:utext="${datainfo.data.detail}"
                         style="overflow:auto"></div>
                </div>
                <div class="fullPaper text-center hide">
                    <a id="fullPaper" style="cursor:pointer;font-size:16px;">View Full Content<i
                            class="fa fa-angle-down"
                            style="margin-left: 10px;color:red;font-weight: bold"
                            aria-hidden="true"></i></a>
                </div>

            </div>

            <div th:if="${datainfo.data.dataList!=null && #lists.size(datainfo.data.dataList)!=0}" id="resources" class="detail_block" ref="browser">
                <div class="block_head">
                    <div class="head_text">
                        <h4>Resources</h4>
                    </div>
                </div>

                <div class="block_content">
                    <div class="el-card filebrowserfunction is-always-shadow"><!---->
                        <div class="el-card__body">
                            <div class="filebrowser el-row">
                                <div class="el-col">
                                    <!--<button type="button" class="el-button dwload el-button&#45;&#45;default">&lt;!&ndash;&ndash;&gt;<i-->
                                            <!--class="el-icon-download"></i><span>-->
                                    <!--Download-->
                                <!--</span></button>-->
                                    <!--<button type="button" class="el-button shareData el-button&#45;&#45;default" @click="shareData()">&lt;!&ndash;&ndash;&gt;<i-->
                                            <!--class="el-icon-share"></i><span>Share</span></button>-->

                                    <!--<button type="button" class="el-button downloadAll el-button&#45;&#45;default">&lt;!&ndash;&ndash;&gt;<i-->
                                            <!--class="el-icon-sold-out"></i><span>Download all files-->
                                    <!--</span></button>-->

                                    <button type="button" class="el-button fork el-button--default" @click="forkData()"><!----><i
                                            class="el-icon-star-off"></i><span>Fork selected data
                                    </span></button>
                                </div>


                                <!--<div class="el-input el-input&#45;&#45;suffix">&lt;!&ndash;&ndash;&gt;<input type="text" autocomplete="off"-->
                                <!--id="searchinput"-->
                                <!--placeholder="search input "-->
                                <!--class="el-input__inner">&lt;!&ndash;&ndash;&gt;<span-->
                                <!--class="el-input__suffix"><span class="el-input__suffix-inner"><i-->
                                <!--class="el-input__icon el-icon-search"></i>&lt;!&ndash;&ndash;&gt;&lt;!&ndash;&ndash;&gt;&lt;!&ndash;&ndash;&gt;</span>-->
                                <!--&lt;!&ndash;&ndash;&gt;</span>&lt;!&ndash;&ndash;&gt;&lt;!&ndash;&ndash;&gt;</div>-->

                            </div>
                        </div>
                    </div>

                    <div class="el-card filecontent is-always-shadow" id="browsercont"
                         style="height: 300px; overflow-y: auto;"><!---->
                        <el-card th:each="item,key:${datainfo.data.dataList}"
                                 th:title="${item.name}" class="dataitemisol" shadow="never" th:id="${item.url}"
                                 th:key="${key}" style="width: 150px;">

                            <el-row>
                                <el-col :span="6">&nbsp</el-col>
                                <el-col :span="12"><img th:src="'/static/img/filebrowser/'+${item.suffix}+'.svg'"
                                                        onerror="this.onerror='';src='/static/img/filebrowser/unknow.svg'"
                                                        style="height: 60%;width:100%"></el-col>
                                <el-col :span="6">&nbsp</el-col>
                            </el-row>
                            <el-row>
                                <el-col :span="2">&nbsp</el-col>
                                <el-col  :span="20" style="display: flex;justify-content: center">

                                    <p style="text-align: center;word-break: break-all;" th:text="${item.name}"></p>
                                    <p th:if="${item.suffix}!='unknow'">.</p>
                                    <p th:text="${item.suffix}!='unknow'?${item.suffix}:''"></p>

                                </el-col>
                                <el-col :span="2">&nbsp</el-col>

                            </el-row>

                            <!--menu item -->


                        </el-card>
                    </div>

                    <div class="el-card browsermenu is-always-shadow"><!---->
                        <div class="el-card__body">
                            <button type="button" class="el-button el-button--text" id="dbtn"><!----><i
                                    class="el-icon-download"></i><span>download
                        </span></button>
                            <br>
                            <button type="button" class="el-button el-button--text" id="sbtn"><!----><i
                                    class="el-icon-share"></i><span>share</span></button>
                        </div>
                    </div>
                </div>
            </div>

            <el-dialog :visible.sync="forkDialogVisible" title="Select Folder" width="35%">

                <el-card style="min-height: 300px;">
                    <el-tree
                            :data="folderTree"
                            ref="folderTree"
                            node-key="id"
                            highlight-current
                            default-expand-all
                            :expand-on-click-node="false"
                            >
                      <span class="custom-tree-node" slot-scope="{ node, data }">
                        <span>{{ node.label }}</span>
                        <!--<span>-->
                          <!--<el-button-->
                                  <!--type="text"-->
                                  <!--size="mini"-->
                                  <!--@click="() => append(data)">-->
                            <!--Append-->
                          <!--</el-button>-->
                          <!--<el-button-->
                                  <!--type="text"-->
                                  <!--size="mini"-->
                                  <!--@click="() => remove(node, data)">-->
                            <!--Delete-->
                          <!--</el-button>-->
                        <!--</span>-->
                      </span>
                    </el-tree>
                </el-card>

                <span slot="footer" class="dialog-footer">
                    <el-button class="pull-left" type="primary" icon="el-icon-folder-add" @click="addFolder()">Add new folder</el-button>
                    <el-button @click="forkDialogVisible = false">Cancel</el-button>
                    <el-button type="primary" @click="confirmFolder()">OK</el-button>
                </span>

            </el-dialog>

            <!--related models-->
            <div id="relatedmodels" class="detail_block">
                <div class="block_head">
                    <div class="head_text">
                        <h4>Related Models</h4>
                    </div>
                </div>
                <div class="block_content flex">

                    <div th:if="${#lists.size(relatedModels)}!=0" style="width:100%">
                        <div class="list_panel clearfix" th:each="model:${relatedModels}">
                            <a th:href="'/modelItem/'+${model.id}" class="img">
                                <img src="/static/img/model/model.png">
                            </a>
                            <div class="info" style="margin-top:0px;">
                                <a th:href="'/modelItem/'+${model.id}" target="_blank"
                                   th:text="${model.name}">Ground Water Flow System</a>
                                <p style="margin-top: 0px" th:text="${model.description}">ANN-CA uses the artificial
                                    neural network method to extract
                                    land use change rules in the study area, and then applies the rules to
                                    subsequent
                                    simulations and predictions.</p>
                            </div>
                        </div>
                        <el-button @click="addRelation()" type="primary" icon="el-icon-plus"
                                   style="width: 100%">
                            Edit Related Model Item
                        </el-button>
                    </div>
                    <div class="text-center" style="width:100%" th:if="${#lists.size(relatedModels)}==0">
                        <h5 style="margin-bottom: 10px;display: inline-block;">
                            There is no related model item. You can link one.
                        </h5>
                        <button class="btn btn-default" type="button"
                                style="display: inline-block;" @click="addRelation()">

                            <i class="fa fa-plus" aria-hidden="true" style="color:#409eff;"></i>
                        </button>
                    </div>

                    <!--<el-tabs value="first" >-->
                    <!--<el-tab-pane label="Related Models List" name="first" style="width: 100%;height:320px;">-->

                    <!--<el-card v-show="relatedModelNotNull"  class="is-hover-shadow relatedModelsInfo"  v-for="item in related3Models" style="margin-top: 10px;margin-bottom: 10px;">-->
                    <!--<div > <strong>Model: <a :href="checkRelatedModels(item)" target="_blank">{{item.name}}</a></strong>-->
                    <!--<br><strong>Description:</strong><span>{{item.description}}</span>-->

                    <!--</div>-->

                    <!--</el-card>-->
                    <!--<el-button v-show="relatedModelNotNull" @click="showRelatedModels" type="primary" icon="el-icon-star-off" style="width: 100%">-->

                    <!--More...-->
                    <!--</el-button>-->
                    <!--<el-card v-show="relatedModelIsNull" class="is-never-shadow relatedModelsInfo" style="margin-top: 10px;margin-bottom: 10px"  >-->
                    <!--<div style="-->
                    <!--text-align: center;-->
                    <!--font-weight: 600;-->
                    <!--margin-top: 30px;-->
                    <!--margin-bottom: 20px;">-->
                    <!--<strong>There are no related models for this data, you can add one!</strong>-->

                    <!--</div>-->

                    <!--<el-button @click="addRelatedModel()" type="primary" icon="el-icon-plus" style="width: 100%">-->
                    <!--add the first model for this data-->
                    <!--</el-button>-->
                    <!--</el-card>-->

                    <!--</el-tab-pane>-->

                    <!--<el-tab-pane label="Search From Related Models" name="second">-->
                    <!--<div style="-->
                    <!--text-align: center;-->
                    <!--font-weight: 600;-->
                    <!--margin-top: 30px;-->
                    <!--margin-bottom: 20px;-->
                    <!--"><span>Search the models from the current data related models</span></div>-->

                    <!--<el-button type="success" @click="showRelatedModels" icon="el-icon-search" style="width: 100%">-->

                    <!--search related-->
                    <!--</el-button>-->

                    <!--</el-tab-pane>-->

                    <!--&lt;!&ndash;search related model dialog&ndash;&gt;-->
                    <!--<el-dialog-->
                    <!--title="Related Models of current Data"-->
                    <!--:visible.sync="searchRelatedModelsDialogVisible"-->
                    <!--width="30%"-->
                    <!--height="50%"-->
                    <!--:before-close="handleClose"-->
                    <!--style="overflow-y: scroll"-->
                    <!--&gt;-->


                    <!--<el-input v-model="relatedModelsSearchText" placeholder="search related models.."  @keyup.native="searchFromRelatedModels"></el-input>-->
                    <!--<el-card id="allReM" class="is-never-shadow" style="height: 300px;overflow-y: scroll" v-loading="loading" @scroll.native="loadMore($event)"  >-->

                    <!--<div class="el-card is-hover-shadow relatedModelsInfo" v-for="item in allRelatedModels" style="margin-top: 10px;margin-bottom: 10px;">-->
                    <!--<div > <strong>Model: <a :href="checkRelatedModels(item)" target="_blank">{{item.name}}</a></strong>-->
                    <!--<br><strong>Description:</strong><span>{{item.description}}</span>-->

                    <!--</div>-->
                    <!--</div>-->
                    <!--<div v-if="nomore!=''" style="text-align: center">-->
                    <!--<span  >no more data</span>-->
                    <!--</div>-->


                    <!--</el-card>-->


                    <!--<span slot="footer" class="dialog-footer">-->
                    <!--<el-button @click="searchRelatedModelsDialogVisible = false">Cancel</el-button>-->
                    <!--<el-button type="primary" @click="searchRelatedModelsDialogVisible = false">Sure</el-button>-->
                    <!--</span>-->
                    <!--</el-dialog>-->

                    <!--<el-tab-pane label="Add Models" name="third">-->
                    <!--<div style="-->
                    <!--text-align: center;-->
                    <!--font-weight: 600;-->
                    <!--margin-top: 30px;-->
                    <!--margin-bottom: 20px;-->
                    <!--"><span>Add the models into the current data related models</span></div>-->
                    <!--<el-button @click="addRelatedModel()" type="primary" icon="el-icon-plus" style="width: 100%">-->
                    <!--add models-->
                    <!--</el-button></br>-->
                    <!--</el-tab-pane>-->

                    <!--&lt;!&ndash;add related model dialog&ndash;&gt;-->
                    <!--<el-dialog-->
                    <!--title="Add Models for current data"-->
                    <!--:visible.sync="addRelatedModelsDialogVisible"-->
                    <!--width="30%"-->
                    <!--:before-close="handleClose">-->


                    <!--<el-form :inline="true"  class="demo-form-inline">-->
                    <!--<el-radio v-model="value1" label="1" @change="clearSearchResult()" >from my created models</el-radio>-->
                    <!--<el-radio v-model="value1" label="2" @change="clearSearchResult()">from all models</el-radio>-->
                    <!--</el-form>-->

                    <!--<el-input v-model="addModelsSearchText" placeholder="search related models and Enter.."  @keyup.enter.native="searchRelatedModels"></el-input></br>-->

                    <!--<el-alert-->
                    <!--title=""-->
                    <!--type="success"-->
                    <!--:closable="false">-->
                    <!--{{selectedModels}}-->

                    <!--</el-alert>-->


                    <!--<el-card v-if="searchAddRelatedModels.length!=0" class="is-never-shadow relatedModelsInfo" style="height: 300px;overflow-y: scroll" v-loading="loading" @scroll.native="loadAddMore($event)" >-->

                    <!--<el-card class="is-hover-shadow models_margin_style" v-for="item in searchAddRelatedModels"   @click.native="selectRelatedModel(item,$event)">-->
                    <!--<div > <strong>Model: <a :href="checkRelatedModels(item)" target="_blank">{{item.name}}</a></strong>-->
                    <!--<br><strong>Description:</strong><span>{{item.description}}</span>-->

                    <!--</div>-->
                    <!--</el-card>-->
                    <!--<div v-if="nomore!=''" style="text-align: center">-->
                    <!--<span  >no more data</span>-->
                    <!--</div>-->


                    <!--</el-card>-->

                    <!--<span slot="footer" class="dialog-footer">-->
                    <!--<el-button @click="relatedToCurrentData()" type="success">RelatedToCurrentData</el-button>-->
                    <!--&lt;!&ndash;<el-button type="primary" @click="addRelatedModelsDialogVisible = false">Close</el-button>&ndash;&gt;-->
                    <!--</span>-->
                    <!--</el-dialog>-->

                    <!--</el-tabs>-->
                </div>

            </div>

            <!--relatedProcessing-->
            <div th:if="${relatedProcessing!=null && #lists.size(relatedProcessing)!=0}" id="related_processing" class="detail_block">
                <div class="block_head">
                    <div class="head_text">
                        <h4>Related Processing</h4>
                    </div>
                </div>
                <el-tabs class="block_content" v-model="activeNameProcessing" type="border-card" stretch="true">
                    <el-tab-pane name="Related Processing">
                        <div slot="label">Related Processing
                            <span class="el-badge__content el-badge__content--undefined"
                                  th:text="${#lists.size(relatedProcessing)}">
                            </span>
                        </div>
                        <div th:if="${#lists.size(relatedProcessing)}!=0">
                            <div class="list_panel" th:each="pro:${relatedProcessing}">
                                <el-card>
                                    <a class="img">
                                        <img src="/static/img/data/Related%20Processing.jpg">
                                    </a>
                                    <div class="info" style="margin-top:0px;">
                                        <a th:text="${pro.proName}">Ground Water Flow System</a>
                                        <p style="margin-top: 0px" th:text="${pro.proDescription}">ANN-CA uses the artificial
                                            neural network method to extract
                                            land use change rules in the study area, and then applies the rules to
                                            subsequent
                                            simulations and predictions.</p>
                                    </div>
                                    <el-button type="success" round  th:id="${pro.proId}" class="processingInvoke" style="margin-top: 10px;float: right;margin-bottom: 8px" @click="invokeProcessing($event);dialogVisible = true">Invoke</el-button>
                                </el-card>
                            </div>

                        </div>
                        <div class="text-center" th:if="${#lists.size(relatedProcessing)}==0">
                            <h5 style="margin-bottom: 10px;display: inline-block;">
                                There is no related model item. You can bind model items.
                            </h5>
                            <button class="btn btn-default" type="button"
                                    style="display: inline-block;">
                                <i class="fa fa-plus" aria-hidden="true" style="color:#409eff;"></i>
                            </button>
                        </div>
                    </el-tab-pane>
                </el-tabs>
            </div>
            <!--relatedVisualization-->
            <div th:if="${relatedVisualization!=null && #lists.size(relatedVisualization)!=0}" id="related_visualization" class="detail_block">
                <div class="block_head">
                    <div class="head_text">
                        <h4>Related Visualization</h4>
                    </div>
                </div>
                <el-tabs class="block_content" v-model="activeNameVisual" type="border-card" stretch="true">
                    <el-tab-pane name="Related Visualization">
                        <div slot="label">Related Visualization
                            <span class="el-badge__content el-badge__content--undefined"
                                  th:text="${#lists.size(relatedVisualization)}">
                            </span>
                        </div>
                        <div th:if="${#lists.size(relatedVisualization)}!=0">
                            <div class="list_panel" th:each="pro:${relatedVisualization}">
                                <el-card>
                                    <a class="img">
                                        <img src="/static/img/data/Related%20Processing.jpg">
                                    </a>
                                    <div class="info" style="margin-top:0px;">
                                        <a th:text="${pro.proName}">Ground Water Flow System</a>
                                        <p style="margin-top: 0px" th:text="${pro.proDescription}">ANN-CA uses the artificial
                                            neural network method to extract
                                            land use change rules in the study area, and then applies the rules to
                                            subsequent
                                            simulations and predictions.</p>
                                    </div>
                                    <el-button type="success" round  th:id="${pro.proId}" class="processingInvokeVisual" style="margin-top: 10px;float: right;margin-bottom: 8px" @click="invokeProcessingVisual($event);dialogVisible = true">Invoke</el-button>
                                </el-card>
                            </div>

                        </div>
                        <div class="text-center" th:if="${#lists.size(relatedVisualization)}==0">
                            <h5 style="margin-bottom: 10px;display: inline-block;">
                                There is no related model item. You can bind model items.
                            </h5>
                            <button class="btn btn-default" type="button"
                                    style="display: inline-block;">
                                <i class="fa fa-plus" aria-hidden="true" style="color:#409eff;"></i>
                            </button>
                        </div>
                    </el-tab-pane>
                </el-tabs>
            </div>

            <!--how to Cite-->
            <div id="cite" class="detail_block">
                <div class="block_head">
                    <div class="head_text">
                        <h4>How to Cite</h4>
                    </div>
                </div>
                <div class="block_content" th:object="${datainfo}">
                    <div id="cite-text" class="">
                        <span th:if="${authorships!=''}"
                              th:text="${authorships}+' ('+${#dates.format(datainfo.data.createTime,'yyyy')}+'). '+${datainfo.data.name}+', Data Item, OpenGMS, '"></span>
                        <span th:if="${authorships==''}"
                              th:text="${user.name}+' ('+${#dates.format(datainfo.data.createTime,'yyyy')}+'). '+${datainfo.data.name}+', Data Item, OpenGMS, '"></span>
                        <a style="word-break:break-all;"
                           th:href="'https://geomodeling.njnu.edu.cn/dataItem/'+${datainfo.data.id}"
                           th:text="'https://geomodeling.njnu.edu.cn/dataItem/'+${datainfo.data.id}"></a>
                    </div>
                    <div id="copy" class="btn btn-info">
                        Copy
                    </div>

                    <!--<el-button>Copy</el-button>-->


                </div>
            </div>

            <div id="copyright" class="detail_block">
                <div class="block_head">
                    <div class="head_text">
                        <h4>Copyright and Disclaimer</h4>
                    </div>
                </div>
                <div class="block_content">
                    <div class="copyright_text">
                        All copyrights of a material (model, data, article, etc.) in the OpenGMS fully belong to its author/developer/designer (or any other wording about the owner). The OpenGMS takes every care to avoid copyright infringement, contributor(s) should carefully employ materials from other sources and give proper citations.
                    </div>
                </div>
            </div>

            <div id="QR0" class="detail_block minScreen">
                <div class="block_head">
                    <div class="head_text" style="padding-left: 10px;">
                        <h4>QR Code</h4>
                    </div>
                </div>
                <div class="block_content">

                    <div class="qrcode" style="width:200px;height:200px;margin: 0px auto;"></div>

                </div>
            </div>

            <div id="comment" class="detail_block">
                <comments></comments>
            </div>

        </div>

        <div class="right-panel el-col">
            <!--categorys-->
            <div id="classification" class="detail_block">
                <div class="block_head">
                    <div class="head_text">
                        <h4>Category Tags</h4>
                    </div>
                </div>
                <div class="block_content" style="margin-bottom:10px;">

                    <!--<el-tag type="success"  v-for="iter in dataCategory" @click="clickDataItemInfo(iter.id)" style="margin-left: 10px;font-weight: bold;color: #3396ef"> {{iter.cateContent}}</el-tag>-->

                    <el-tag type="success" th:each="classS:${classifications}" th:text="${classS}"
                            style="margin: 0 10px 10px 0;font-weight: bold;color: #3396ef"></el-tag>

                </div>
            </div>

            <div id="Owner" class="detail_block">

                <div class="block_head">
<!--                    <div class="head_text" style="padding-left: 10px;">-->
<!--                        <h4 th:if="${history!=true}">Contributor</h4>-->
<!--                        <h4 th:if="${history==true}">Modifier</h4>-->
                    <div class="head_text" style="padding-left: 10px;padding-right: 15px;display: inline-flex">
                        <h4>Contributor</h4>
                        <el-tooltip popper-class="fontsize-15" effect="light" content="Contributor is the person who contributes the item to OpenGMS, may not be the author of the item." placement="top">
                            <i class="fa fa-question-circle-o" aria-hidden="true" style="margin-top:4px;cursor:help;"></i>
                        </el-tooltip>
                    </div>

                </div>

                <div class="block_content">
                    <div class="el-row" style="margin-bottom: 3px;height: 40px;display: flex;justify-content: center;align-items: center;">
                        <user-avatar ref="mainContributorAvatar1" style="width:40px;height: 40px;float:left;"></user-avatar>
                        <div class="el-col">
                            <div class="pull-left" style="display: block;margin-left: 15px;">
                                <a th:href="'/profile/'+${user.userId}"><h4 th:text="${user.name}" style="padding: 0;">Tom Marvolo Riddle</h4></a>
                            </div>
                        </div>
                    </div>
                    <div class="el-row">
                        <div class="text-center">
                            <h5 th:text="'contributed at '+${#dates.format(datainfo.data.createTime,'yyyy-MM-dd')}">
                                contributed at 2018-7-13 14:32:18 </h5>
                        </div>
                    </div>
                </div>
            </div>

            <div id="Authorship" class="detail_block"
                 th:if="${datainfo.data.authorships!=null&&#lists.size(datainfo.data.authorships)!=0}">
                <div class="block_head">
                    <div class="head_text" style="padding-left: 10px;padding-right: 15px;display: inline-flex">                         <h4>Authorship</h4>                         <el-tooltip popper-class="fontsize-15" effect="light"                                     content="We deeply understand that a model may be attributed to the efforts of a team. If all author information is not listed here, please click the feedback below."                                     placement="top">                             <i class="fa fa-question-circle-o" aria-hidden="true" style="margin-top:4px;cursor:help;"></i>                         </el-tooltip>                     </div>
                </div>
                <div class="block_content text-center" style="padding-left:10px">

                    <div style="text-align: left;" th:each="author,key:${datainfo.data.authorships}">
                        <span role="button" tabindex="0" class="ab" style="float: right;"><a
                                data-toggle="collapse" th:href="'#authorships'+${key.index}" class="detail-toggle"
                                aria-expanded="true" ><i class="fa fa-caret-up" style="font-size: 21px"></i></a></span>
                        <li class="NavHead" style="font-size: 16px;" th:text="${author.name}">NNU_Group</li>
                        <div th:id="'authorships'+${key.index}" class="panel-collapse" th:class="${key.index==0?'in':'collapse'}"aria-expanded="true"
                             style="">
                            <div class="panel-body" style="padding-left: 20px; padding-top: 7px; padding-right: 0px;">
                                <dl>
                                    <dt th:if="${author.ins!=''&&author.ins!=null}">Affiliation：</dt>
                                    <dd th:if="${author.ins!=''&&author.ins!=null}" th:text="${author.ins}"></dd>
                                    <div th:if="${author.email!='unknow'&&author.email!=''}">
                                        <dt>Email：</dt>
                                        <dd th:text="${author.email}">njgis@163.com</dd>
                                    </div>
                                    <dt th:if="${author.homepage!=''}">Home Page：</dt>
                                    <dd th:if="${author.homepage!=''}"><a th:href="${author.homepage}">View</a></dd>
                                </dl>
                            </div>
                        </div>
                    </div>

                    <div th:if="${#lists.size(datainfo.data.authorships)>0}">
                        <el-tag type="info">Is authorship not correct? <a href="javascript:void(0)" @click="feedBack" style="text-decoration: underline">Feed back</a></el-tag>
                    </div>

                </div>
            </div>

            <div id="QR" class="detail_block">
                <div class="block_head">
                    <div class="head_text" style="padding-left: 10px;">
                        <h4>QR Code</h4>
                    </div>
                </div>
                <div class="block_content">

                    <div class="qrcode" style="width:200px;height:200px;margin: 0px auto;"></div>

                </div>
            </div>

        </div>
        <div th:if="${history==true}"
             style="pointer-events:none;position: absolute;top:0;bottom: 0;left: 0;right: 0;background-image: url('/static/img/historyBackground.png')"></div>

        <!--Relation 弹出框-->
        <el-dialog style="float:left" :visible.sync="dialogTableVisible" title="Add Related Model Item"
                   width="70%" top="40px">

            <div style="padding: 8px 16px;
                        background-color: #ecf8ff;
                        border-radius: 4px;
                        border-left: 5px solid #50bfff;
                        margin: 0 0 10px;">
                <p style="font-size: 14px;color: #5e6d82;line-height: 1.5em;margin:0;">
                    You can link related <code style="background-color: #f9fafc;color: #5e6d82;">Model Item</code> from your personal space to this model item, or you can <a style="cursor:pointer;text-decoration: underline" @click="jump">create</a> a new <span>model item</span>.
                </p>
            </div>

            <el-card shadow="never" class="box-card" style="width:40%;margin-right: 1%;float: left;">
                <div slot="header" class="clearfix">
                    <span>Related Items</span>

                </div>
                <el-table
                        :data="tableData"
                        ref="leftTable"
                        :max-height="tableMaxHeight">

                    <el-table-column
                            label="Name">
                        <template slot-scope="props">
                            <a :href="'/modelItem/'+props.row.id" target="_blank">{{props.row.name}}</a>
                        </template>
                    </el-table-column>

                    <el-table-column fixed="right" label="Operation" width="100">
                        <template slot-scope="scope">

                            <el-button
                                    :disabled="scope.row.author!=userUid&&scope.row.author_uid!=userUid"
                                    size="mini"
                                    type="danger"
                                    @click="handleDelete(scope.$index, scope.row)">Remove
                            </el-button>
                        </template>
                    </el-table-column>
                </el-table>
            </el-card>

            <el-card shadow="never" class="box-card" style="width:59%;">
                <el-input placeholder="Please enter name..." v-model="relateSearch" class="input-with-select" clearable="true" @keyup.enter.native="search()">
                    <el-button slot="append" icon="el-icon-search" @click="search()"></el-button>
                </el-input>
                <el-table
                        :data="pageOption.searchResult"
                        style="margin-top:17px;"
                        :max-height="tableMaxHeight">
                    <el-table-column type="expand">
                        <template slot-scope="props">
                            <el-form label-position="left" inline class="demo-table-expand">
                                <el-form-item label="Detail">
                                    <span>{{ props.row.overview }}</span>
                                </el-form-item>

                            </el-form>
                        </template>
                    </el-table-column>
                    <el-table-column
                            label="Name">
                        <template slot-scope="props">
                            <a :href="'/repository/'+relateType+'/'+props.row.id"
                               target="_blank">{{props.row.name}}</a>
                        </template>
                    </el-table-column>
                    <!--<el-table-column-->
                            <!--label="Contributor"-->
                            <!--prop="author">-->
                    <!--</el-table-column>-->
                    <el-table-column fixed="right" label="Operation" width="100">
                        <template slot-scope="scope">
                            <el-button
                                    size="mini"
                                    @click="handleEdit(scope.$index, scope.row)">Add
                            </el-button>

                        </template>
                    </el-table-column>
                </el-table>
                <el-pagination style="text-align: center;margin-top:20px"
                               @current-change="handlePageChange"
                               :current-page="pageOption.currentPage"
                               layout="total, prev, pager, next, jumper"
                               :page-size="5"
                               :total="pageOption.total">
                </el-pagination>
            </el-card>
            <div slot="footer" class="dialog-footer">

                <el-button @click="dialogTableVisible = false;">Cancel</el-button>
                <el-button type="primary" @click="confirm()">OK</el-button>
            </div>
        </el-dialog>
        <el-dialog
                v-loading="loading2"
                title="Invoke"
                :visible.sync="dialogVisible"
                width="80%"
                :before-close="handleClose">
            <el-card>
                <div class="xmlDisplay" style="display: inline-block;width: 60%;">
                    <p v-if="processingType =='process'" style="font-weight: 600">XML description of processing:</p><br>
                    <p v-if="processingType == 'visual'" style="font-weight: 600">XML description of visualization:</p><br>
                    <pre v-if="xml" lang="xml">{{xml}}</pre>
                </div>
                <div class="parameterInput" style="display: inline-block;float: right;width: 35%">
                    <p style="font-weight: 600">Parameters to be filled in:</p><br>
                    <div class="parameter" v-for = "(para,i) in parameters">
                        <p>{{para}}</p>
                        <input type="text" autocomplete="off" placeholder="Please enter the content" :id ="para" class="el-input__inner">
                    </div>
                </div>
            </el-card>
            <span slot="footer" class="dialog-footer">
                <el-button @click="dialogVisible = false">Cancel</el-button>
                <el-button type="primary" @click="invokeProcessingNow();dialogVisible = false">Invoke Now</el-button>
            </span>
        </el-dialog>

    </div>

    <div th:replace="fragments/footer :: footer"></div>

</div>

<template th:replace="fragments/comments :: comments"></template>
<template th:replace="modules/userAvatar :: userAvatar"></template>
</body>
<script th:inline="javascript">
    var author=[[${user}]];
</script>

<script th:src="@{/static/js/common/vue.min.js}"></script>
<script th:src="@{/static/element-ui/index.js}"></script>
<script th:src="@{/static/js/common/jquery-3.3.1.min.js}"></script>
<script th:src="@{/static/js/common/jquery.rotate.min.js}"></script>
<script src="/static/js/common/bootstrap.min.js"></script>
<script src="/static/js/modules/userAvatar.js"></script>
<script src="/static/js/modules/comments.js"></script>
<script src="/static/js/common/vue-avatar.min.js"></script>

<script src="/static/js/common/axios.min.js"></script>

<script src="/static/js/common/qrcode.min.js"></script>
<script src="/static/js/apidoc/dataApi.js"></script>
<script src="/static/js/page/data_item_info.js" th:src="@{/static/js/page/data_item_info.js}"></script>

<script src="/static/js/common/copy.js"></script>
<script src="/static/element-ui/umd/locale/en.js"></script>
<script src="/static/js/common/navbar.js"></script>

</html>